---
title: 子弹类与子弹移动函数
date: 2024-10-14
updated: 2024-10-14
permalink: articles/Zhong classmate/项目1-提瓦特幸存者/
categories: Zhong classmate
tags: [项目总结]
---

# 子弹类与子弹移动函数

## 子弹类

```c++
class Bullet
{
public:
	POINT position = { 0, 0 };

public:
	Bullet() = default;
	~Bullet() = default;

	void Draw() const
	{
		setlinecolor(RGB(255, 155, 50));
		setfillcolor(RGB(200, 75, 10));
		fillcircle(position.x, position.y, RADIUS);
	}

private:
	const int RADIUS = 10;
};
```

### 1. 成员变量

- `POINT position`:
  - 这是一个 `POINT` 结构，通常用于表示一个二维坐标点。这里初始化为 `{ 0, 0 }`，表示子弹的初始位置在坐标原点。

### 2. 构造和析构函数

- `Bullet() = default;`:
  - 默认构造函数，没有特别的初始化逻辑，只是简单地创建一个 `Bullet` 对象。

- `~Bullet() = default;`:
  - 默认析构函数，编译器会自动处理内存清理。

### 3. 绘制函数

- `void Draw() const`:
  - 这是一个常量成员函数，表示该函数不会修改类的成员变量。
  - 绘制子弹图形
    - `setlinecolor(RGB(255, 155, 50));`:
      - 设置线条颜色为橙色，RGB值为 (255, 155, 50)。
    - `setfillcolor(RGB(200, 75, 10));`:
      - 设置填充颜色为深橙色，RGB值为 (200, 75, 10)。
    - `fillcircle(position.x, position.y, RADIUS);`:
      - 在 `position` 指定的坐标处绘制一个半径为 `RADIUS` 的填充圆，表示子弹。

### 4. 常量成员

- `const int RADIUS = 10;`:
  - 声明了一个常量 `RADIUS`，值为 10，表示子弹的半径。



## 子弹移动函数

```c++
void UpdateBullets(std::vector<Bullet>& bullet_list, const Player& player)
{
	const double RADIAL_SPEED = 0.0055;							// 径向波动速度
	const double TANGENT_SPEED = 0.0045;						// 切向波动速度
	double radian_interval = 2 * 3.14159 / bullet_list.size();	// 子弹之间的弧度间隔
	POINT player_position = player.GetPosition();
	double radius = 100 + 25 * sin(GetTickCount() * RADIAL_SPEED);
	for (size_t i = 0; i < bullet_list.size(); i++)
	{
		double radian = GetTickCount() * TANGENT_SPEED + radian_interval * i;	// 当前子弹所在弧度值
		bullet_list[i].position.x = player_position.x + player.FRAME_WIDTH / 2 + (int)(radius * sin(radian));
		bullet_list[i].position.y = player_position.y + player.FRAME_HEIGHT / 2 + (int)(radius * cos(radian));
	}
}
```

### 1. 常量定义

- `RADIAL_SPEED` 和 `TANGENT_SPEED`:
  - 定义了子弹在径向和切向上的移动速度。
  - 使子弹不仅拥有圆周运动的切向速度，还有不断波动的径向速度（半径方向上的往复运动）

### 2. 弧度计算

- `double radian_interval = 2 * 3.14159 / bullet_list.size();`:
  - 计算子弹之间的弧度间隔，使子弹均匀分布。

### 3. 获取玩家位置

- `POINT player_position = player.GetPosition();`:
  - 获取玩家的当前位置（根据玩家位置进行绘制）

### 4. 半径计算

- `double radius = 100 + 25 * sin(GetTickCount() * RADIAL_SPEED);`:
  - 根据时间不同，动态计算子弹距离角色中心的半径距离

### 5. 更新子弹位置

- 使用循环遍历 `bullet_list` 中的每个子弹:
  - `double radian = GetTickCount() * TANGENT_SPEED + radian_interval * i;`:
    
    - 计算每个子弹的当前所处的弧度值α(alpha)。
    
  - 根据当前子弹所处的弧度值α(alpha)计算出子弹的 `x` 和 `y` 坐标，并更新子弹位置，使其围绕玩家的位置移动。
  
    ![](articles/Zhong classmate/项目1-提瓦特幸存者/image//1.png)





代码参考：Voidmatrix

项目教程：【【从零开始的C++游戏开发】全宇宙最简单的类吸血鬼幸存者游戏开发 | EasyX制作提瓦特幸存者】https://www.bilibili.com/video/BV1eM4m1S74K?vd_source=3a9720f4e51b97861a15c946ae6f0c2d

文档错误请联系QQ1210965642
